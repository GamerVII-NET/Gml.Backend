@page "/profiles-list"

<PageTitle>ProfilesList</PageTitle>
<RadzenRow>
    <RadzenColumn Size="12">
        <RadzenText Text="Profiles" TextStyle="TextStyle.H3" TagName="TagName.H1"/>
        <RadzenRow>
            <RadzenColumn>

                <RadzenDataGrid TItem="Models.GmlApi.GetProfileDto" Data="@getProfileDtos" @bind-value="@SelectedProfiles" ColumnWidth="200px" AllowSorting="true" AllowFiltering="true" SelectionMode="Radzen.DataGridSelectionMode.Single" AllowRowSelectOnRowClick="true">
                    <Columns>
                        <RadzenDataGridColumn TItem="GmlAdminPanel.Models.GmlApi.GetProfileDto" Property="Name" Title="Name"/>
                        <RadzenDataGridColumn TItem="GmlAdminPanel.Models.GmlApi.GetProfileDto" Property="LaunchVersion" Title="LaunchVersion"/>
                        <RadzenDataGridColumn TItem="GmlAdminPanel.Models.GmlApi.GetProfileDto" Property="GameVersion" Title="GameVersion"/>
                    </Columns>
                </RadzenDataGrid>
            </RadzenColumn>

        </RadzenRow>

        @if (SelectedProfiles?.Any() == true)
        {
            <RadzenRow class="mt-3">
                <RadzenColumn>
                    @if (SelectedProfiles?.Any() == true)
                    {
                        <RadzenCard>
                            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" Gap="5">

                                <RadzenStack Visible="ProfileInfo == null">

                                    <div class="spinner-border spinner-border-sm" role="status">
                                        <span class="visually-hidden">Загрузка...</span>
                                    </div>
                                </RadzenStack>
                                <RadzenText Text="Profile"/>

                            </RadzenStack>
                            <RadzenText Text="@SelectedProfiles[0].Name" TextStyle="Radzen.Blazor.TextStyle.DisplayH6" Style="margin-top: 8px"/>

                            <RadzenRow Style="margin-top: 10px" Visible="!(ProfileInfo == null)">
                                <RadzenColumn class="d-flex flex-column align-items-center justify-content-center">
                                    <RadzenStack Visible="@IsPackaging" Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center">

                                        <div class="spinner-border spinner-border-sm" role="status">
                                            <span class="visually-hidden">Загрузка...</span>
                                        </div>
                                        <RadzenText Text="Packaging..."/>

                                    </RadzenStack>
                                    <RadzenButton Style="width: 100%; visibility: visible" Text="Package profile" Click="@PackageSelectedProfile" Visible="(IsPackaging == false)" Icon="archive"/>
                                </RadzenColumn>

                                <RadzenColumn class="d-flex align-items-end">
                                    <RadzenButton Style="width: 100%" ButtonStyle="Radzen.ButtonStyle.Light" Text="for Windows" Click="@LoadAdditionalDataWindows" Icon="get_app">
                                    </RadzenButton>
                                </RadzenColumn>
                                <RadzenColumn class="d-flex align-items-end">
                                    <RadzenButton Style="width: 100%" ButtonStyle="Radzen.ButtonStyle.Light" Text="for Linux" Click="@LoadAdditionalDataLinux" Icon="get_app">
                                    </RadzenButton>
                                </RadzenColumn>
                                <RadzenColumn class="d-flex  align-items-end">
                                    <RadzenButton Style="width: 100%" ButtonStyle="Radzen.ButtonStyle.Light" Text="for OsX" Click="@LoadAdditionalDataMacOs" Icon="get_app"></RadzenButton>
                                </RadzenColumn>
                                <RadzenColumn class="d-flex flex-column align-items-center justify-content-center">
                                    <RadzenStack Visible="@IsRemoving" Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center">

                                        <div class="spinner-border spinner-border-sm" role="status">
                                            <span class="visually-hidden">Загрузка...</span>
                                        </div>
                                        <RadzenText Text="Removing..."/>

                                    </RadzenStack>
                                    <RadzenButton Style="width: 100%;" Text="Remove profile" Click="@RemoveSelectedProfile" ButtonStyle="Radzen.ButtonStyle.Danger" Visible="(IsRemoving == false)" Icon="delete"/>
                                </RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                            </RadzenRow>

                        </RadzenCard>
                    }
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow class="mt-3">
                <RadzenCard class="w-100">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" Gap="5">

                        <RadzenStack Visible="ProfileInfo == null">

                            <div class="spinner-border spinner-border-sm" role="status">
                                <span class="visually-hidden">Загрузка...</span>
                            </div>
                        </RadzenStack>
                        <RadzenText Text="Files"/>

                    </RadzenStack>

                    <RadzenRow class="mt-3">
                        <RadzenColumn>
                            @* <RadzenDataGrid TItem="Models.GmlApi.File" *@
                            @*                 Data="@ProfileInfo?.Files" Visible="!(ProfileInfo == null)" *@
                            @*                 AllowPaging="true" *@
                            @*                 AllowFiltering="true" *@
                            @*                 PageSize="10"> *@
                            @*     <Columns> *@
                            @*         <RadzenDataGridColumn TItem="Models.GmlApi.File" Property="Directory" Title="Downloading files"/> *@
                            @*         <RadzenDataGridColumn TItem="Models.GmlApi.File" Property="Size" Title="Size"/> *@
                            @*     </Columns> *@
                            @* </RadzenDataGrid> *@

                            <RadzenTree Data=@entries Expand=@LoadFiles Style="width: 100%; height: 300px">
                                <RadzenTreeLevel Text=@GetTextForNode Template=@FileOrFolderTemplate/>
                            </RadzenTree>
                        </RadzenColumn>
                        <RadzenColumn>
                            <RadzenDataGrid TItem="string" Data="@ProfileInfo?.WhiteListFiles" Visible="!(ProfileInfo == null)">
                                <Columns>
                                    <RadzenDataGridColumn TItem="string" Property="." Title="Not check files"/>
                                </Columns>
                            </RadzenDataGrid>
                            <RadzenText Text="Files in this list will not be forcibly updated on the client side" class="mt-3" TextStyle="Radzen.Blazor.TextStyle.Caption"/>
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenCard>

            </RadzenRow>
        }

    </RadzenColumn>
</RadzenRow>
